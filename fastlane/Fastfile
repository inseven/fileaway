# This file contains the fastlane.tools configuration
# You can find the documentation at https://docs.fastlane.tools
#
# For a list of all available actions, check out
#
#     https://docs.fastlane.tools/actions
#
# For a list of all available plugins, check out
#
#     https://docs.fastlane.tools/plugins/available-plugins
#

skip_docs

lane :release do

    output_directory = "builds"
    output_name = "Fileaway"
    target = File.join(output_directory, output_name + ".app")

    gym(
        scheme: "Fileaway macOS",
        output_directory: output_directory,
        output_name: output_name,
        export_options: {
            method: "developer-id",
            teamID: ENV['APPLE_TEAM_ID']
        }
    )
    notarize(
        package: target,
        username: ENV['APPLE_DEVELOPER_ID'],
    )
    zip(
        path: target,
        output_path: target + ".zip"
    )

end

lane :test do
    sh("../scripts/test.sh")
end
